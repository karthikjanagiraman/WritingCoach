@import "tailwindcss";
@plugin "@tailwindcss/typography";

@theme {
  /* Tier 1: Playful & Warm */
  --color-tier1-primary: #FF6B6B;
  --color-tier1-secondary: #4ECDC4;
  --color-tier1-accent: #FFE66D;
  --color-tier1-bg: #FFF9F0;
  --color-tier1-text: #2D3436;

  /* Tier 2: Confident & Cool */
  --color-tier2-primary: #6C5CE7;
  --color-tier2-secondary: #00B894;
  --color-tier2-accent: #FDCB6E;
  --color-tier2-bg: #F8F9FD;
  --color-tier2-text: #2D3436;

  /* Tier 3: Sophisticated & Focused */
  --color-tier3-primary: #2D3436;
  --color-tier3-secondary: #0984E3;
  --color-tier3-accent: #E17055;
  --color-tier3-bg: #FFFFFF;
  --color-tier3-text: #2D3436;

  /* Dynamic active tier aliases — Tier 1 defaults (overridden by body class) */
  --color-active-primary: #FF6B6B;
  --color-active-secondary: #4ECDC4;
  --color-active-accent: #FFE66D;
  --color-active-bg: #FFF9F0;
  --color-active-text: #2D3436;

  /* Universal */
  --color-success: #00B894;
  --color-warning: #FDCB6E;
  --color-error: #FF7675;
}

/* Dynamic tier colors — switched via body class */
/* Override --color-active-* directly so Tailwind utilities resolve correctly */
body.tier-2 {
  --color-active-primary: #6C5CE7;
  --color-active-secondary: #00B894;
  --color-active-accent: #FDCB6E;
  --color-active-bg: #F8F9FD;
  --color-active-text: #2D3436;
}

body.tier-3 {
  --color-active-primary: #2D3436;
  --color-active-secondary: #0984E3;
  --color-active-accent: #E17055;
  --color-active-bg: #FFFFFF;
  --color-active-text: #2D3436;
}

/* Layout tokens */
:root {
  --header-height: 5.5rem;
  --phase-bar-height: 0rem;
  --content-height: calc(100vh - var(--header-height));
}

@layer base {
  body {
    font-family: "Nunito", -apple-system, BlinkMacSystemFont, sans-serif;
    color: #2D3436;
  }

  body.tier-2 {
    font-family: "DM Sans", -apple-system, BlinkMacSystemFont, sans-serif;
  }

  body.tier-3 {
    font-family: "Sora", -apple-system, BlinkMacSystemFont, sans-serif;
  }

  .writing-area {
    font-family: "Literata", Georgia, serif;
  }
}

/* Animations */
@keyframes bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}

@keyframes typing {
  0%, 100% { opacity: 0.3; transform: translateY(0); }
  50% { opacity: 1; transform: translateY(-4px); }
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes fadeInPlace {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes scoreReveal {
  from { width: 0; }
}

@keyframes starPop {
  0% { transform: scale(0); }
  50% { transform: scale(1.3); }
  100% { transform: scale(1); }
}

.animate-bounce-slow {
  animation: bounce 2s infinite;
}

.animate-fade-in {
  animation: fadeIn 0.4s ease-out both;
}

.animate-fade-in-slow {
  animation: fadeIn 0.6s ease-out both;
}

.animate-fade-in-place {
  animation: fadeInPlace 0.3s ease-out both;
}

.animate-typing-dot {
  animation: typing 1.4s infinite;
}

.animate-star-pop {
  animation: starPop 0.4s ease-out forwards;
}

@keyframes emojiPop {
  0% { transform: scale(0); }
  60% { transform: scale(1.2); }
  100% { transform: scale(1); }
}

@keyframes dotFill {
  from { opacity: 0; transform: scale(0.5); }
  to { opacity: 1; transform: scale(1); }
}

.animate-emoji-pop {
  animation: emojiPop 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) both;
}

.animate-dot-fill {
  animation: dotFill 0.3s ease-out both;
}

/* Stagger utilities */
.stagger-1 { animation-delay: 0.1s; }
.stagger-2 { animation-delay: 0.2s; }
.stagger-3 { animation-delay: 0.3s; }
.stagger-4 { animation-delay: 0.4s; }
.stagger-5 { animation-delay: 0.5s; }

/* Pulse border animation for active writing cards */
@keyframes pulse-border {
  0%, 100% { border-color: var(--color-active-accent); box-shadow: 0 0 0 0 rgba(255, 230, 109, 0); }
  50% { border-color: #f0d84e; box-shadow: 0 0 12px 2px rgba(255, 230, 109, 0.20); }
}

.animate-pulse-border {
  animation: pulse-border 2.5s ease-in-out infinite;
}

/* Lined paper background for writing areas */
.writing-lined {
  background-image: repeating-linear-gradient(
    to bottom,
    transparent,
    transparent 29px,
    #e8e4dd 29px,
    #e8e4dd 30px
  );
  background-position: 0 12px;
}

/* Accessibility: focus-visible for keyboard navigation */
:focus-visible {
  outline: 2px solid var(--color-active-primary);
  outline-offset: 2px;
}

/* ══ Quest / Placement animations ══ */
@keyframes ambientFloat {
  0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
  10% { opacity: var(--op, 0.3); }
  90% { opacity: var(--op, 0.3); }
  100% { transform: translateY(-20vh) rotate(var(--rot, 360deg)); opacity: 0; }
}

@keyframes orbFloat {
  0%, 100% { transform: translateY(0) scale(1); }
  50% { transform: translateY(-8px) scale(1.1); }
}

@keyframes headerCharBreathe {
  0%, 100% { transform: translateY(0) scale(1); }
  50% { transform: translateY(-4px) scale(1.03); }
}

@keyframes glowPulse {
  0%, 100% { box-shadow: 0 0 0 4px var(--glow-color, #FF6B6B)12, 0 0 24px var(--glow-color, #FF6B6B)18, 0 8px 32px var(--glow-color, #FF6B6B)15; }
  50% { box-shadow: 0 0 0 6px var(--glow-color, #FF6B6B)18, 0 0 36px var(--glow-color, #FF6B6B)25, 0 8px 32px var(--glow-color, #FF6B6B)20; }
}

@keyframes celebBounce {
  0% { transform: scale(0) rotate(-20deg); }
  60% { transform: scale(1.1) rotate(5deg); }
  100% { transform: scale(1) rotate(0); }
}

@keyframes confettiFall {
  0% { transform: translateY(0) rotate(0) scale(1); opacity: 1; }
  80% { opacity: 1; }
  100% { transform: translateY(var(--fd, 400px)) rotate(var(--rot, 720deg)) scale(0.5); opacity: 0; }
}

@keyframes starTwinkle {
  0%, 100% { opacity: 0.3; transform: scale(0.8); }
  50% { opacity: 1; transform: scale(1.2); }
}

@keyframes charReveal {
  from { opacity: 0; transform: translateY(30px) scale(0.5) rotate(-10deg); }
  to { opacity: 1; transform: translateY(0) scale(1) rotate(0); }
}

@keyframes btnShine {
  0%, 100% { transform: translateX(-100%) rotate(30deg); }
  50% { transform: translateX(100%) rotate(30deg); }
}

@keyframes ollieJump {
  0% { transform: scale(0) translateY(40px); }
  60% { transform: scale(1.15) translateY(-10px); }
  100% { transform: scale(1) translateY(0); }
}

@keyframes badgePop {
  from { transform: scale(0) rotate(-45deg); }
  to { transform: scale(1) rotate(0); }
}

@keyframes fadeUp {
  from { opacity: 0; transform: translateY(16px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* ══ Quest Intro (V3 narration) ══ */
@keyframes introGlowPulse {
  0%, 100% { transform: translate(-50%, -55%) scale(1); opacity: 0.6; }
  50% { transform: translate(-50%, -55%) scale(1.15); opacity: 1; }
}

@keyframes introMascotEntrance {
  from { opacity: 0; transform: translateY(-60px) scale(0.3) rotate(-15deg); }
  to { opacity: 1; transform: translateY(0) scale(1) rotate(0); }
}

@keyframes introFloat {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-8px); }
}

.intro-highlight { color: #FF6B6B; font-weight: 800; }
.intro-name { color: #FF6B6B; font-weight: 900; }

/* Accessibility: respect reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}
